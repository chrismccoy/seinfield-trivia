<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0"
    />
    <title>The Trivia About Nothing</title>

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />

    <link
      href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@500;700&family=Inter:wght@900&display=swap"
      rel="stylesheet"
    />

    <link
      href="/css/app.css"
      rel="stylesheet"
    />

    <script
      defer
      src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"
    ></script>

    <script src="/js/trivia.js"></script>

  </head>

  <body
    class="overflow-x-hidden min-h-screen"
    data-session-prefix="<%= sessionConfig.SESSION_PREFIX %>"
    data-storage-key="<%= sessionConfig.LOCAL_STORAGE_KEY %>"
    data-session-id-length="<%= sessionConfig.SESSION_ID_LENGTH %>"
  >
    <div
      class="max-w-7xl mx-auto bg-white border-x-4 border-black min-h-screen relative shadow-hard-xl my-0 sm:my-8"
    >
      <nav class="border-b-4 border-black bg-white sticky top-0 z-50">
        <div class="p-4 flex items-center justify-between gap-4">
          <div class="flex items-center gap-3">
            <div
              class="w-10 h-10 bg-pop-pink border-2 border-black flex items-center justify-center shadow-hard-sm"
              aria-hidden="true"
            >
              <span class="font-sans font-black">S</span>
            </div>

            <div class="leading-none">
              <h1
                class="font-sans font-black text-3xl tracking-tighter uppercase italic -rotate-2"
              >
                Seinfeld
                <span class="text-pop-cyan text-stroke">Trivia</span>
              </h1>
              <div class="font-mono font-bold text-xs uppercase tracking-widest">
                THE TRIVIA ABOUT NOTHING
              </div>
            </div>
          </div>

          <div
            class="hidden sm:flex items-center gap-2 border-2 border-black shadow-hard-sm px-3 py-2 bg-pop-yellow"
          >
            <span class="font-mono font-bold text-xs uppercase tracking-widest">
              SESSION
            </span>
            <span class="font-mono font-black text-xs uppercase tracking-widest">
              ACTIVE
            </span>
          </div>
        </div>
      </nav>

      <div
        class="bg-black text-pop-yellow border-b-4 border-black overflow-hidden py-2"
        aria-label="Seinfeld keywords ticker"
      >
        <div class="whitespace-nowrap animate-marquee flex gap-8">
          <span class="font-mono font-bold text-xl tracking-widest">
            ★ NO SOUP FOR YOU ★ YADA YADA YADA ★ GIDDY UP ★ SERENITY NOW ★
            MASTER OF YOUR DOMAIN ★ HELLO, NEWMAN ★ FESTIVUS ★ THE CONTEST ★
            THE MARINE BIOLOGIST ★
          </span>
          <span class="font-mono font-bold text-xl tracking-widest">
            ★ NO SOUP FOR YOU ★ YADA YADA YADA ★ GIDDY UP ★ SERENITY NOW ★
            MASTER OF YOUR DOMAIN ★ HELLO, NEWMAN ★ FESTIVUS ★ THE CONTEST ★
            THE MARINE BIOLOGIST ★
          </span>
          <span class="font-mono font-bold text-xl tracking-widest">
            ★ NO SOUP FOR YOU ★ YADA YADA YADA ★ GIDDY UP ★ SERENITY NOW ★
            MASTER OF YOUR DOMAIN ★ HELLO, NEWMAN ★ FESTIVUS ★ THE CONTEST ★
            THE MARINE BIOLOGIST ★
          </span>
        </div>
      </div>

      <main
        x-data='triviaGame(<%- JSON.stringify(initialQuestion).replace(/\x3c/g, "\\x3c").replace(/\x3e/g, "\\x3e").replace(/\x27/g, "\\x27") %>)'
        class="p-6 md:p-10"
        role="main"
      >
        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
          <aside class="hidden lg:block lg:col-span-3">
            <div class="bg-white border-4 border-black shadow-hard-md p-5">
              <h2 class="font-sans font-black text-2xl uppercase">
                Quote Wall
              </h2>

              <div class="mt-5 grid gap-3">
                <div class="border-2 border-black shadow-hard-sm p-4 bg-pop-yellow">
                  <div class="font-mono font-bold text-[10px] uppercase tracking-widest">
                    Kramer
                  </div>
                  <div class="font-mono font-bold text-sm">“Giddy up!”</div>
                </div>

                <div class="border-2 border-black shadow-hard-sm p-4 bg-pop-pink">
                  <div class="font-mono font-bold text-[10px] uppercase tracking-widest">
                    Soup Nazi
                  </div>
                  <div class="font-mono font-bold text-sm">“No soup for you!”</div>
                </div>

                <div class="border-2 border-black shadow-hard-sm p-4 bg-pop-cyan">
                  <div class="font-mono font-bold text-[10px] uppercase tracking-widest">
                    Elaine
                  </div>
                  <div class="font-mono font-bold text-sm">“Get out!”</div>
                </div>

                <div class="border-2 border-black shadow-hard-sm p-4 bg-white">
                  <div class="font-mono font-bold text-[10px] uppercase tracking-widest">
                    Jerry
                  </div>
                  <div class="font-mono font-bold text-sm">“Hello, Newman.”</div>
                </div>

                <div class="border-2 border-black shadow-hard-sm p-4 bg-pop-lime">
                  <div class="font-mono font-bold text-[10px] uppercase tracking-widest">
                    Frank
                  </div>
                  <div class="font-mono font-bold text-sm">“Serenity now!”</div>
                </div>

                <div class="border-2 border-black shadow-hard-sm p-4 bg-pop-orange">
                  <div class="font-mono font-bold text-[10px] uppercase tracking-widest">
                    George
                  </div>
                  <div class="font-mono font-bold text-sm">
                    “It’s not a lie if you believe it.”
                  </div>
                </div>

                <div class="border-2 border-black shadow-hard-sm p-4 bg-pop-purple">
                  <div class="font-mono font-bold text-[10px] uppercase tracking-widest">
                    George
                  </div>
                  <div class="font-mono font-bold text-sm">“I was in the pool!”</div>
                </div>

                <div class="border-2 border-black shadow-hard-sm p-4 bg-white">
                  <div class="font-mono font-bold text-[10px] uppercase tracking-widest">
                    Festivus
                  </div>
                  <div class="font-mono font-bold text-sm">
                    “I’ve got a lot of problems with you people!”
                  </div>
                </div>

                <div class="border-2 border-black shadow-hard-sm p-4 bg-pop-yellow">
                  <div class="font-mono font-bold text-[10px] uppercase tracking-widest">
                    Elaine
                  </div>
                  <div class="font-mono font-bold text-sm">
                    “Maybe the dingo ate your baby.”
                  </div>
                </div>

                <div class="border-2 border-black shadow-hard-sm p-4 bg-pop-cyan">
                  <div class="font-mono font-bold text-[10px] uppercase tracking-widest">
                    George
                  </div>
                  <div class="font-mono font-bold text-sm">
                    “These pretzels are making me thirsty!”
                  </div>
                </div>

                <div class="border-2 border-black shadow-hard-sm p-4 bg-pop-pink">
                  <div class="font-mono font-bold text-[10px] uppercase tracking-widest">
                    Jerry
                  </div>
                  <div class="font-mono font-bold text-sm">
                    “Not that there’s anything wrong with that.”
                  </div>
                </div>
              </div>
            </div>
          </aside>

          <section class="lg:col-span-6 relative">
            <header
              class="mb-6 text-center blur-transition"
              :class="{'opacity-30 blur-sm': showWelcomeModal}"
            >
              <div
                class="inline-flex items-center gap-3 bg-pop-yellow border-4 border-black shadow-hard-lg px-4 py-3 -rotate-1"
              >
                <div
                  class="w-10 h-10 bg-pop-pink border-2 border-black shadow-hard-sm flex items-center justify-center"
                  aria-hidden="true"
                >
                  <span class="font-sans font-black">?</span>
                </div>
                <h2
                  class="font-sans font-black text-3xl sm:text-4xl uppercase tracking-tighter"
                >
                  Seinfeld Trivia
                </h2>
              </div>

              <div x-show="!gameEnded" class="mt-4">
                <p
                  class="font-mono font-bold text-sm uppercase tracking-widest"
                  aria-live="polite"
                >
                  Score:
                  <span
                    class="bg-white border-2 border-black shadow-hard-sm px-2 py-1 inline-block"
                  >
                    <span class="font-black" x-text="stats.correct"></span>
                    /
                    <span class="font-black" x-text="stats.total"></span>
                  </span>
                </p>
              </div>

              <div
                x-show="hasAnswered && !gameEnded"
                class="mt-4 border-4 border-black shadow-hard-lg p-4 bg-white"
                x-transition
                aria-live="polite"
              >
                <div class="text-center">
                  <p
                    x-show="isCorrect"
                    class="inline-block bg-pop-cyan border-2 border-black shadow-hard-sm px-3 py-2 font-sans font-black uppercase"
                  >
                    Giddy Up!
                  </p>
                  <p
                    x-show="!isCorrect"
                    class="inline-block bg-pop-pink border-2 border-black shadow-hard-sm px-3 py-2 font-sans font-black uppercase"
                  >
                    No soup for you!
                  </p>

                  <p x-show="!isCorrect" class="mt-3 font-mono font-bold text-sm">
                    Answer:
                    <span
                      class="bg-black text-pop-yellow px-2 py-1 border-2 border-black shadow-hard-sm inline-block"
                      x-text="currentQuestion.correct_answer"
                    ></span>
                  </p>
                </div>

                <div class="flex gap-4 justify-center mt-4">
                  <button
                    @click="endGame()"
                    class="px-6 py-3 border-2 border-black shadow-hard-sm bg-white font-sans font-black uppercase btn-pop"
                  >
                    End
                  </button>
                  <button
                    @click="fetchNext()"
                    class="px-8 py-3 border-2 border-black shadow-hard-sm bg-black text-white font-sans font-black uppercase btn-pop flex items-center gap-2"
                  >
                    Next <span aria-hidden="true">&rarr;</span>
                  </button>
                </div>
              </div>

              <p
                class="mt-4 font-mono font-bold uppercase tracking-widest"
                x-show="gameEnded"
              >
                That's a shame.
              </p>
            </header>

            <div
              x-show="showWelcomeModal"
              x-cloak
              class="absolute left-0 right-0 z-50 flex justify-center"
              style="top: 7.5rem;"
              x-transition:enter="transition ease-out duration-200"
              x-transition:enter-start="opacity-0 scale-95"
              x-transition:enter-end="opacity-100 scale-100"
              role="dialog"
              aria-labelledby="resume-heading"
              aria-modal="true"
            >
              <div class="absolute inset-x-0 -top-6 -bottom-6 bg-white/70" aria-hidden="true"></div>

              <div
                class="relative bg-white border-4 border-black p-6 shadow-hard-xl text-center w-full max-w-sm"
              >
                <h3
                  id="resume-heading"
                  class="font-sans font-black text-2xl uppercase"
                >
                  Giddy Up!
                </h3>
                <p class="font-mono font-bold mt-2 text-sm text-black/70">
                  We found an active session. Continue where you left off?
                </p>

                <div class="flex flex-col gap-3 mt-6">
                  <button
                    @click="continueSession()"
                    class="w-full bg-pop-cyan text-black font-sans font-black py-3 px-4 border-2 border-black shadow-hard-md btn-pop flex justify-between items-center uppercase"
                  >
                    <span>Continue</span>
                    <span class="bg-white border-2 border-black shadow-hard-sm px-2 py-1 font-mono font-bold text-xs">
                      <span x-text="savedStats.correct"></span>/<span x-text="savedStats.total"></span>
                    </span>
                  </button>

                  <button
                    @click="startFresh()"
                    class="w-full bg-black text-white font-sans font-black py-3 px-4 border-2 border-black shadow-hard-md btn-pop uppercase"
                  >
                    Start Fresh
                  </button>
                </div>
              </div>
            </div>

            <div
              class="blur-transition min-h-card relative"
              :class="{'opacity-30 pointer-events-none blur-sm': showWelcomeModal}"
            >
              <div
                x-show="loading"
                class="absolute inset-0 z-10 bg-white/95 flex flex-col items-center justify-center border-4 border-black shadow-hard-xl"
                x-transition.opacity
                role="status"
                aria-label="Loading next question"
              >
                <div
                  class="w-16 h-16 bg-pop-yellow border-4 border-black shadow-hard-lg flex items-center justify-center mb-4"
                  aria-hidden="true"
                >
                  <span class="font-sans font-black text-2xl">!</span>
                </div>
                <p class="font-mono font-bold uppercase tracking-widest text-sm bg-black text-pop-yellow px-3 py-2 border-2 border-black shadow-hard-sm">
                  Checking the vault...
                </p>
              </div>

              <div
                x-show="fetchError"
                x-cloak
                class="mb-4 p-4 bg-pop-pink border-4 border-black shadow-hard-md font-mono font-bold text-sm text-center"
                role="alert"
              >
                <span x-text="fetchError"></span>
                <button @click="fetchNext()" class="underline ml-2 font-black">
                  Retry
                </button>
              </div>

              <div x-show="!gameEnded && currentQuestion" class="relative">
                <div class="absolute inset-0 bg-black translate-x-2 translate-y-2" aria-hidden="true"></div>

                <div class="relative bg-white border-4 border-black overflow-hidden">
                  <div class="bg-white px-6 py-4 border-b-4 border-black">
                    <div class="flex justify-between items-center mb-2">
                      <span class="font-mono font-bold uppercase tracking-widest text-xs">
                        Episode Info
                      </span>

                      <span
                        :class="{
                          'bg-pop-cyan text-black': currentQuestion.difficulty === 'easy',
                          'bg-pop-yellow text-black': currentQuestion.difficulty === 'medium',
                          'bg-pop-pink text-black': currentQuestion.difficulty === 'hard',
                          'bg-black text-white': !['easy','medium','hard'].includes(currentQuestion.difficulty)
                        }"
                        class="text-xs font-mono font-bold uppercase px-3 py-1 border-2 border-black shadow-hard-sm"
                        role="status"
                        :aria-label="'Difficulty: ' + currentQuestion.difficulty"
                      >
                        <span x-text="currentQuestion.difficulty"></span>
                      </span>
                    </div>

                    <span
                      x-text="currentQuestion.category"
                      class="font-sans font-black text-xl uppercase tracking-tight block"
                    ></span>
                  </div>

                  <div class="p-6">
                    <div class="bg-pop-yellow border-2 border-black shadow-hard-sm p-4 rotate-[0.5deg]">
                      <h3
                        class="font-sans font-black text-xl leading-snug min-h-[4rem]"
                        x-text="currentQuestion.question"
                      ></h3>
                    </div>

                    <div class="grid gap-3 mt-5" role="group" aria-label="Answer choices">
                      <template x-for="(answer, idx) in allAnswers" :key="answer">
                        <button
                          @click="selectAnswer(answer)"
                          :disabled="hasAnswered"
                          :aria-label="'Option ' + (idx + 1) + ': ' + answer"
                          class="w-full text-left p-4 border-2 border-black shadow-hard-sm btn-pop font-mono font-bold relative"
                          :class="{
                            'bg-white': !hasAnswered,
                            'bg-pop-cyan': hasAnswered && answer === currentQuestion.correct_answer,
                            'bg-pop-pink': hasAnswered && answer === selectedAnswer && answer !== currentQuestion.correct_answer,
                            'opacity-60': hasAnswered && answer !== currentQuestion.correct_answer && answer !== selectedAnswer
                          }"
                        >
                          <div class="flex items-start gap-3">
                            <span
                              class="inline-flex items-center justify-center w-8 h-8 bg-black text-white border-2 border-black shadow-hard-sm flex-shrink-0 font-sans font-black"
                              x-text="idx + 1"
                              aria-hidden="true"
                            ></span>
                            <span x-text="answer"></span>
                          </div>

                          <span
                            x-show="hasAnswered && answer === currentQuestion.correct_answer"
                            class="absolute right-4 top-4 font-sans font-black text-xl"
                            aria-hidden="true"
                          >
                            ✓
                          </span>
                          <span
                            x-show="hasAnswered && answer === selectedAnswer && answer !== currentQuestion.correct_answer"
                            class="absolute right-4 top-4 font-sans font-black text-xl"
                            aria-hidden="true"
                          >
                            ✕
                          </span>
                        </button>
                      </template>
                    </div>
                  </div>
                </div>
              </div>

              <div
                x-show="gameEnded"
                x-cloak
                class="relative"
                x-transition:enter="transition ease-out duration-500"
                x-transition:enter-start="opacity-0 translate-y-4"
                x-transition:enter-end="opacity-100 translate-y-0"
                role="region"
                aria-label="Game results"
              >
                <div class="absolute inset-0 bg-black translate-x-2 translate-y-2" aria-hidden="true"></div>

                <div class="relative bg-white border-4 border-black p-8 text-center">
                  <h3 class="font-sans font-black text-3xl uppercase mb-2">
                    Session Complete
                  </h3>
                  <p class="font-mono font-bold text-sm text-black/70">
                    Are you master of your domain?
                  </p>

                  <div class="grid grid-cols-2 gap-4 my-8">
                    <div class="bg-pop-cyan p-4 border-2 border-black shadow-hard-sm">
                      <div class="text-5xl font-sans font-black" x-text="stats.correct"></div>
                      <div class="text-xs uppercase tracking-widest font-mono font-bold">
                        Correct
                      </div>
                    </div>
                    <div class="bg-pop-pink p-4 border-2 border-black shadow-hard-sm">
                      <div class="text-5xl font-sans font-black" x-text="stats.total - stats.correct"></div>
                      <div class="text-xs uppercase tracking-widest font-mono font-bold">
                        Incorrect
                      </div>
                    </div>
                  </div>

                  <div class="mb-8 text-left border-2 border-black shadow-hard-sm p-4">
                    <div class="flex justify-between text-sm mb-2 font-mono font-bold uppercase tracking-widest">
                      <span>Accuracy</span>
                      <span class="bg-pop-yellow px-2 py-1 border-2 border-black shadow-hard-sm" x-text="calculatePercentage() + '%'"></span>
                    </div>

                    <div
                      class="w-full bg-white border-2 border-black shadow-hard-sm h-5 overflow-hidden"
                      role="progressbar"
                      :aria-valuenow="calculatePercentage()"
                      aria-valuemin="0"
                      aria-valuemax="100"
                    >
                      <div
                        class="bg-black h-full transition-all duration-700 ease-out"
                        :style="`width: ${calculatePercentage()}%`"
                      ></div>
                    </div>
                  </div>

                  <button
                    @click="startFresh()"
                    class="w-full bg-pop-yellow border-2 border-black px-8 py-4 shadow-hard-md font-sans font-black uppercase btn-pop"
                  >
                    Start New Session
                  </button>
                </div>
              </div>
            </div>
          </section>

          <aside class="hidden lg:block lg:col-span-3">
            <div class="bg-white border-4 border-black shadow-hard-md p-5">
              <h2 class="font-sans font-black text-2xl uppercase">
                Stats
              </h2>

              <div class="mt-5 border-4 border-black shadow-hard-lg p-4 bg-white">
                <div class="grid gap-3">
                  <div class="border-2 border-black shadow-hard-sm p-4 bg-pop-yellow">
                    <div class="font-mono font-bold text-xs uppercase tracking-widest">
                      Score
                    </div>
                    <div class="font-sans font-black text-4xl">
                      <span x-text="stats.correct"></span>/<span x-text="stats.total"></span>
                    </div>
                  </div>

                  <div class="border-2 border-black shadow-hard-sm p-4 bg-pop-cyan">
                    <div class="font-mono font-bold text-xs uppercase tracking-widest">
                      Accuracy
                    </div>
                    <div class="font-sans font-black text-4xl">
                      <span x-text="calculatePercentage()"></span>%
                    </div>
                  </div>
                </div>

                <button
                  type="button"
                  class="mt-4 w-full bg-black text-white border-2 border-black shadow-hard-sm px-4 py-3 font-sans font-black uppercase btn-pop"
                  @click="startFresh()"
                >
                  Reset Session
                </button>
              </div>

              <div class="mt-6 border-4 border-black shadow-hard-lg p-4 bg-white">
                <div class="flex items-baseline justify-between gap-3">
                  <h3 class="font-sans font-black text-xl uppercase">Cast</h3>
                  <span class="font-mono font-bold text-[10px] uppercase tracking-widest text-black/70">
                    Top 10
                  </span>
                </div>

                <div class="mt-4 grid grid-cols-1 gap-3">
                  <div class="border-2 border-black shadow-hard-sm p-3 bg-white flex items-center justify-between">
                    <span class="font-mono font-bold text-[10px] uppercase tracking-widest">01</span>
                    <span class="font-sans font-black uppercase">Jerry</span>
                  </div>
                  <div class="border-2 border-black shadow-hard-sm p-3 bg-pop-pink flex items-center justify-between">
                    <span class="font-mono font-bold text-[10px] uppercase tracking-widest">02</span>
                    <span class="font-sans font-black uppercase">George</span>
                  </div>
                  <div class="border-2 border-black shadow-hard-sm p-3 bg-pop-cyan flex items-center justify-between">
                    <span class="font-mono font-bold text-[10px] uppercase tracking-widest">03</span>
                    <span class="font-sans font-black uppercase">Elaine</span>
                  </div>
                  <div class="border-2 border-black shadow-hard-sm p-3 bg-pop-yellow flex items-center justify-between">
                    <span class="font-mono font-bold text-[10px] uppercase tracking-widest">04</span>
                    <span class="font-sans font-black uppercase">Kramer</span>
                  </div>
                  <div class="border-2 border-black shadow-hard-sm p-3 bg-pop-lime flex items-center justify-between">
                    <span class="font-mono font-bold text-[10px] uppercase tracking-widest">05</span>
                    <span class="font-sans font-black uppercase">Newman</span>
                  </div>
                  <div class="border-2 border-black shadow-hard-sm p-3 bg-pop-orange flex items-center justify-between">
                    <span class="font-mono font-bold text-[10px] uppercase tracking-widest">06</span>
                    <span class="font-sans font-black uppercase">Frank</span>
                  </div>
                  <div class="border-2 border-black shadow-hard-sm p-3 bg-pop-purple flex items-center justify-between">
                    <span class="font-mono font-bold text-[10px] uppercase tracking-widest">07</span>
                    <span class="font-sans font-black uppercase">Estelle</span>
                  </div>
                  <div class="border-2 border-black shadow-hard-sm p-3 bg-white flex items-center justify-between">
                    <span class="font-mono font-bold text-[10px] uppercase tracking-widest">08</span>
                    <span class="font-sans font-black uppercase">Morty</span>
                  </div>
                  <div class="border-2 border-black shadow-hard-sm p-3 bg-pop-pink flex items-center justify-between">
                    <span class="font-mono font-bold text-[10px] uppercase tracking-widest">09</span>
                    <span class="font-sans font-black uppercase">Helen</span>
                  </div>
                  <div class="border-2 border-black shadow-hard-sm p-3 bg-pop-cyan flex items-center justify-between">
                    <span class="font-mono font-bold text-[10px] uppercase tracking-widest">10</span>
                    <span class="font-sans font-black uppercase">Puddy</span>
                  </div>
                </div>
              </div>
            </div>
          </aside>
        </div>
      </main>

      <footer class="bg-black text-white p-6 border-t-4 border-black">
        <div class="flex flex-col md:flex-row justify-between gap-6">
          <div>
            <h2 class="font-sans font-black text-3xl text-pop-yellow">
              SEINFELD TRIVIA
            </h2>
            <p class="font-mono font-bold text-xs text-gray-300 mt-2">
              A show about nothing. A quiz about everything.
            </p>
          </div>

          <div class="font-mono font-bold text-xs text-gray-400 md:text-right">
            © <%= new Date().getFullYear() %> — YADA YADA YADA.
          </div>
        </div>
      </footer>
    </div>
  </body>
</html>
